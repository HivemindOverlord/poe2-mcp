import{j as e}from"./chunk.D_zvdyIk.mjs";import{A as N}from"./chunk.BmqzvNR7.mjs";import{L as w}from"./chunk.DDozxiHY.mjs";import{T}from"./chunk.D6R8QL2x.mjs";import{c as V,d as M,e as b}from"./chunk.C9OyDJWF.mjs";import{B as g}from"./chunk.0V1bX42r.mjs";import{S as f,L}from"./chunk.Cmq6oGK-.mjs";import{L as P}from"./chunk.DiEU1_Oo.mjs";import{r as l}from"./chunk.BODK_9N1.mjs";import{b as k}from"./chunk.DejOMADx.mjs";import{P as F}from"./chunk.B9tV1REN.mjs";import{g as I}from"./chunk.GPgAE6ai.mjs";import{C as z}from"./chunk.Bk0Vc9ns.mjs";import{l as R}from"./chunk.B-KvE2rF.mjs";import{C as U}from"./chunk.D3i7DvJT.mjs";import{C as A}from"./chunk.DDz-GxiV.mjs";import"./chunk.DQCDsE9B.mjs";import"./chunk.E3NT3XWd.mjs";import"./chunk.7dHyCQ4N.mjs";import"./chunk.DukJqk8i.mjs";import"./chunk.lvoRU39Q.mjs";/* empty css               */import"./chunk.C1f41G33.mjs";import"./chunk.CTYVyYCx.mjs";import"./chunk.D6QZVm5V.mjs";import"./chunk.B9UYGmbU.mjs";import"./chunk.C7ioRvaq.mjs";import"./chunk.D5J6QNPe.mjs";import"./chunk.BrKbGvCA.mjs";import"./chunk.DA7z0usA.mjs";import"./chunk.CJcM0Pjx.mjs";import"./chunk.Bei1Sl8l.mjs";import"./chunk.CN1BNjWq.mjs";import"./chunk.lANkT6lr.mjs";import"./chunk.D7B1ASpA.mjs";import"./chunk.B20cMwr0.mjs";import"./chunk.C2o-M7y5.mjs";import"./chunk.BZd6EGAW.mjs";import"./chunk.BlTxHScW.mjs";import"./chunk.DujAsWCP.mjs";import"./chunk.BMK3XW_3.mjs";import"./chunk.CXqqvRIL.mjs";import"./chunk.CB4IRot7.mjs";import"./chunk.Cz0CWeBA.mjs";function B(s){const[t,a]=l.useState(null),[n,d]=l.useState([]),[o,C]=l.useState(!1),[S,y]=l.useState(),u=l.useMemo(()=>{const i=new URLSearchParams(window.location.search);let r=i.has("search")?i.get("search"):null,m=i.has("i")?Number.parseInt(i.get("i")):null;m=Number.isNaN(m)?0:m,r=r?.length>0?r:"";let c=[];const x=V(s.snapshotVersion,r),v=localStorage.getItem(x.key);return v&&(c=JSON.parse(v).pairs),{search:r,index:m,chars:c,pagingInfo:x}},[s.snapshotVersion]);l.useEffect(()=>{async function i(){const r=await N.getCharacter(s.account,s.name,s.snapshotVersion.snapshotName,h(),s.snapshotVersion.version);if(r.notFound){if(C(!0),r.response.headers.has("tmz")){const c=r.response.headers.get("tmz")?.split(",")??[];d(c)}return}const m=r.result;if(r.response.headers.has("tmz")){const c=r.response.headers.get("tmz")?.split(",")??[];d(c)}a(m),y(k("pob2://poeninja/overview/code",{account:encodeURIComponent(s.account),name:encodeURIComponent(s.name),overview:s.snapshotVersion.snapshotName,timeMachine:h()},{}))}i()},[s.account,s.name,s.snapshotVersion]);const p=e.jsx(F,{...I(s.name,t)});return o?e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[p,e.jsx(j,{...u,timeMachineLabels:n,...s}),e.jsxs(f,{className:"col-span-5",children:[e.jsx(f.Header,{children:"Not Found"}),e.jsx(f.Content,{children:e.jsx(P,{children:n.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"prose",children:"The character was not found in this time machine snapshot."}),e.jsx("p",{className:"prose",children:"However, it does exist in other time machine snapshots, which you can select from the dropdown above."})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"prose",children:"The character was not found."}),e.jsx("p",{className:"prose",children:"This could be due to a misspelled name or the character having been removed."}),e.jsxs("p",{className:"prose",children:["If this happens unexpectedly, please try again later or report it in"," ",e.jsx("a",{href:R.discordServer,children:"Discord"}),"."]})]})})})]})]}):t===null?e.jsxs("div",{children:[p,e.jsx(j,{...u,timeMachineLabels:n,...s}),e.jsx(w,{})]}):e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[p,e.jsx(j,{...u,timeMachineLabels:n,...s}),e.jsx(z,{char:t,timeMachineLabel:h(),pobOpenLink:S})]})}function j({search:s,index:t,chars:a,pagingInfo:n,timeMachineLabels:d,...o}){return e.jsx("nav",{"aria-label":"secondary",style:{gridColumn:"span 5"},children:e.jsxs(L,{justify:"space-between",align:"flex-end",children:[e.jsxs(L,{children:[e.jsx(g,{element:"a",variant:"solid",size:"large",href:M(o.snapshotVersion,s),children:"Back to search"}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridGap:"var(--s2)"},children:t>=0&&t<a.length?e.jsxs(e.Fragment,{children:[e.jsxs(g,{element:t>0?"a":"button",variant:"solid",size:"large",className:"w-40",disabled:t===0,href:t>0?b(o.snapshotVersion,a[t-1][0],a[t-1][1],h(),t-1,n):void 0,children:[e.jsx(U,{className:"h-6"}),"Previous"]}),e.jsxs(g,{element:t+1<a.length?"a":"button",variant:"solid",size:"large",className:"w-40",disabled:t+1===a.length,href:t+1<a.length?b(o.snapshotVersion,a[t+1][0],a[t+1][1],h(),t+1,n):null,children:["Next",e.jsx(A,{className:"h-6"})]})]}):null})]}),o.snapshotVersion.timeMachineLabels&&o.snapshotVersion.timeMachineLabels.length>0&&e.jsx(T,{snapshotVersion:o.snapshotVersion,dropdownLabel:"Time Machine",characterTimeMachineLabels:d})]})})}function h(){const s=new URLSearchParams(window.location.search);return s.has("timemachine")?s.get("timemachine"):null}function Me(s){const t=N.useIndexState();if(t.isLoading)return e.jsx(w,{});if(t.error)return e.jsxs("div",{children:["Error: ",t.error.message]});const a=t.data.snapshotVersions.find(n=>n.url===s.league);return e.jsx(B,{snapshotVersion:a,account:s.account,name:s.name,overviewType:a.overviewType})}export{Me as CharPageWrapper};
